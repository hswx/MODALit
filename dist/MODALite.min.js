/*
 *  Modalite v0.1.5
 *  https://knot-design.jp/MODALite/
 *  Author: Yuji Hisamatsu (https://github.com/knot-design)
 *  Copyright (C) 2017 Knot Design
 *  Licensed under the MIT license (MIT)
*/
!function(t,e){"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?module.exports=e():t.MODALite=e()}(this,function(){"use strict";function t(t){var e=t.el&&"string"!=typeof t.el?t.el:n(t.el||'[data-toggle="modal"]'),i=e.length;2>i&&(e=0===i?0:e[0],i=0),this.options=o(t,d),i?[].forEach.call(e,this.init.bind(this)):this.init(e)}var e=document,i=t.prototype,n=function(t,i,n){return i=i||e,i=!t.match(/\s/)&&t[0].match(/(#|\.)/)?"#"===t[0]?i.getElementById(t.slice(1)):i.getElementsByClassName(t.slice(1)):i.querySelectorAll(t),n&&void 0!==i.length?i[0]:i},a=function(t){var e=0,i=t.firstElementChild,a=n(".content",i,1);if("ajax"===t.getAttribute("data-modal-media")){a.style.height="auto",[].forEach.call(i.children,function(t){e+=t.tagName.match(/(header|footer)/i)?t.clientHeight:0});var o=i.offsetHeight-e;a.clientHeight>o&&(a.style.height=o+"px")}"full"!==t.getAttribute("data-modal-width")&&/^(centered|left|right)$/.test(t.getAttribute("data-modal-position"))&&(i.style.marginTop=-(i.offsetHeight/2)+"px")},o=function(t,e){for(var i in e)try{e[i].constructor===Object?t[i]=o(t[i],e[i]):void 0===t[i]&&(t[i]=e[i])}catch(n){t[i]=e[i]}return t},s=function(t,i){var o,s,d=[],l=t&&t.getAttribute("data-target")?t.getAttribute("data-target"):i.target,h=l?n(l,0,1):"",u=t&&t.getAttribute("data-src")?t.getAttribute("data-src"):i.src;if(!h){h=e.createElement("div"),e.body.appendChild(h),t&&["title","content","footer"].forEach(function(e){null!==t.getAttribute("data-"+e)&&(i[e]=t.getAttribute("data-"+e))});var m=i.title?"<header><h3>"+i.title+"</h3></header>":"";if(u?(d=r(u),o=d[0]||'<span class="loader"></span>',i.footer="ajax"!==d[1]?!1:i.footer,h.setAttribute("data-modal-media",d[1]),"video"===d[1]&&h.setAttribute("data-modal-iframe",!0)):o=i.content,o=o?'<div class="content">'+o+"</div>":"",i.footer){var f=i.action.fn?i.cancel:i.action;s='<footer><button type="button" data-modal-btn="dismiss" class="'+f["class"]+'">'+f.label+"</button>%%</footer>",s=s.replace("%%",i.action.fn?'<button type="button" data-modal-btn="action" class="'+i.action["class"]+'">'+i.action.label+"</button>":"")}else s='<span data-modal-btn="dismiss"></span>';h.innerHTML='<div class="dialog">'+m+o+s+"</div>"}return["transition","position","width"].forEach(function(e){i[e]=t&&null!==t.getAttribute("data-"+e)?t.getAttribute("data-"+e):i[e],i[e]&&h.setAttribute("data-modal-"+e,i[e])}),h.classList.add("modalite"),h.setAttribute("aria-hidden","true"),i.backdrop&&h.classList.add("backdrop"),"ajax"===d[1]&&c(u,function(t){n(".content",h,1).innerHTML=t,a(h)}),a(h),h},r=function(t){var e=t.match(/^(?:https?:\/\/)?(?:www\.)?(?:youtu\.be\/|youtube\.com\/(?:embed\/|v\/|watch\?v=|watch\?.+&v=))((\w|-){11})(?:\S+)?$/),i=t.match(/\/\/(player\.)?vimeo\.com\/([a-z]*\/)*([0-9]{6,11})[?]?.*/),n=t.match(/.+dailymotion.com\/(video|hub)\/([^_]+)[^#]*(#video=([^_&]+))?/),a=t.match(/^.+.(mp4|m4v|ogg|ogv|webm)$/),o=t.match(/^.+.(jpg|jpeg|gif|png|svg)$/i);if(a)return['<video src="'+t+'" width="640" height="360" controls="true"></video>',"embed"];if(o)return['<img src="'+t+'">',"image"];if(e&&11===e[1].length)t="//www.youtube.com/embed/"+e[1];else if(i&&i[3].length)t="//player.vimeo.com/video/"+i[3];else{if(!n||!n[2].length)return[null,"ajax"];t="//www.dailymotion.com/embed/video/"+n[2]}return['<iframe src="'+t+'" allowfullscreen="true" width="640" height="360"></iframe>',"video"]},c=function(t,e){var i=new XMLHttpRequest;i.open("get",t),i.onload=function(){200==i.status?e(i.responseText):console.error("Request Error: "+i.status)},i.send()},d={backdrop:!0,fixed:"fixed",position:"centered",footer:!0,action:{label:"OK","class":"btn primary"},cancel:{label:"Cancel","class":"btn light"},dismiss:{backdrop:!0,esc:!0}};return i.init=function(t){this.modal=s(t,this.options),t&&t.addEventListener("click",this.show.bind(this,this.modal))},i.show=function(t,i){var o=null,s=this.options;this.listner={},this.btn={trigger:i&&(i.currentTarget||i.target),action:n('[data-modal-btn="action"]',t,1),cancel:n('[data-modal-btn="dismiss"]',t,1)},this.btn.trigger&&this.btn.trigger.classList.add("active"),t.setAttribute("aria-hidden","false"),s.action.fn&&(this.listner.action=s.action.fn.bind(this),this.btn.action.addEventListener("click",this.listner.action)),s.cancel.fn&&(this.listner.cancel=s.cancel.fn.bind(this),this.btn.cancel.addEventListener("click",this.listner.cancel)),t.addEventListener("click",this.hide.bind(this)),s.dismiss.esc&&e.addEventListener("keyup",function(t){27===t.keyCode&&this.hide()}.bind(this)),window.addEventListener("resize",function(){clearTimeout(o),o=setTimeout(a.bind(null,t),200)}),a(t),this.modal=t,s.backdrop&&s.fixed&&e.body.classList.add(s.fixed)},i.hide=function(t){var i=this.options,n=!t||!!(i.dismiss.backdrop&&!this.modal.firstElementChild.contains(t.target)||this.btn.cancel.contains(t.target));n&&(this.modal.setAttribute("aria-hidden","true"),this.btn.trigger&&this.btn.trigger.classList.remove("active"),i.fixed&&i.backdrop&&e.body.classList.remove(i.fixed),this.listner.action&&this.btn.action.removeEventListener("click",this.listner.action),this.listner.cancel&&this.btn.cancel.removeEventListener("click",this.listner.cancel))},t});
